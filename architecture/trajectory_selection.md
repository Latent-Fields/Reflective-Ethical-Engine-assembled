# Trajectory selection (E3)

E3 evaluates candidate sensorimotor futures and **commits** to one trajectory.

E3 is not a perceptual system and does not overwrite the shared sensory latent. Its role is to:
- select a coherent sensorimotor future from an affordance space,
- raise precision on the selected plan (commitment), and
- convert hypothetical rollouts into **learning-relevant** prediction errors after action.

## Inputs and representational domains

REE distinguishes two primary latents:
- **Shared sensory latent** \(z_S\): reliability-weighted, fused multimodal evidence (completed perception).
- **Affordance/action latent** \(z_A\): candidate sensorimotor futures generated by fast forward prediction.

E3 operates on \(z_A\), which is derived from \(z_S\) via E2. E3 does not operate directly on raw modality streams.

## Candidate generation (E2 → \(z_A\))

Generate \(N\) candidate trajectories \(\zeta_i\) by rolling the fast forward predictor (E2) forward from the current shared sensory latent \(z_S\) for horizon \(H\).

Common options:
- Model Predictive Control (MPC) rollouts with random shooting.
- Cross-Entropy Method (CEM) sampling.
- Beam search for discrete action spaces.

## Scoring

Score each candidate with:

\[
J(\zeta)=\mathcal{F}(\zeta)+\lambda\,M(\zeta)+\rho\,\Phi_R(\zeta)
\]

Where (implementation-dependent, but conceptually stable):
- \(\mathcal{F}(\zeta)\): feasibility / coherence / constraint satisfaction (including physical viability and internal consistency across predictive depths).
- \(M(\zeta)\): mission-aligned objective terms (task progress, care objectives, etc.).
- \(\Phi_R(\zeta)\): residue curvature term (persistent ethical cost; path dependent).

## Commitment as precision gating

Commitment is implemented as a **precision increase** at action/control depth (\(\beta\) and sometimes \(\gamma\)):

- reduce action entropy for the selected plan
- increase weighting of action-level prediction error (stabilises execution)

This corresponds to dopamine-like commitment without requiring a reward-only interpretation.

### Epistemic consequence of commitment

Before commitment, rollouts are **hypotheses**. After commitment, the selected trajectory is treated as **intended**.

This matters because only committed outcomes make errors *diagnostic* of the model.
E3 therefore acts as an **epistemic commitment gate**:
- uncommitted rollouts do not trigger belief update
- committed trajectories produce learning-relevant prediction errors after action

## Error routing after action

After executing the committed plan, prediction errors are routed by domain:

- **Perceptual error** (sensory mismatch in \(z_S\)) → updates perceptual priors via error-weighted updates (no semantic overwrite).
- **Affordance / procedural error** (predicted trajectory vs achieved) → updates E2 rollout model (what actions tend to do).
- **Deep model error** (systematic mismatch across contexts) → updates E1 (slow, integrative world/self model).
- **Value mismatch / moral residue** (harm/benefit deviation; constraint violations) → updates residue field \(\phi(z)\) / \(\Phi_R\).

## Attention and precision coupling

Attention is implemented as **precision (gain) modulation**.
E3 interacts with attention by:
- requesting increased precision on task-relevant sensory channels (to reduce ambiguity during execution), and/or
- lowering precision in internal simulation modes where trajectories are exploratory rather than committed.

In REE, attention changes the *weight* of error signals; it does not inject new sensory content.

## Ethical constraints as architectural consequences

Many practical rules (e.g., avoid harm, prefer benefit, disclose risks/benefits/alternatives to support capacity) can be modelled as
constraints and scoring terms that emerge from the architecture:
- harm/benefit prediction appears naturally as part of scoring candidate futures
- commitment makes outcomes attributable (and therefore ethically and epistemically relevant)
- residue makes ethical cost path dependent and persistent

These rules are therefore not treated as the deepest ethical primitives; they are operational constraints that arise from a cognition
architecture that must act under uncertainty while preserving corrigibility and responsibility.

## Related components

- Shared sensory latent and timescale stack: `latent_stack.md`
- Residue geometry (field vs path): `residue_geometry.md`
- Path memory and replay (hippocampal braid): `hippocampal_braid.md`
- Internal generative mode (Default Mode Network analogue): `default_mode.md`
